10.0.217.84;12481
10.0.217.84;22485
10.0.217.84;2481
10.0.217.84;2485
10.0.217.84;2465
10.0.227.102;12481
10.0.227.102;22485
10.0.227.102;2481
10.0.227.102;2485
10.0.227.102;2465
10.0.97.47;22485
10.0.97.47;2481
10.0.97.47;2485
10.0.97.47;2465
10.0.97.87;22485
10.0.97.87;2481
10.0.97.87;2485
10.0.97.87;2465
10.116.114.195;21
10.116.76.227;1500
10.116.76.227;1581
10.116.76.253;1500
10.116.76.253;1581
10.116.76.254;1500
10.116.76.254;1581
10.116.93.43;5432
10.118.164.33;2495
10.122.146.104;1500
10.122.146.104;1581
10.122.146.105;1500
10.122.146.105;1581
10.122.146.115;1500
10.122.146.115;1581
10.122.146.116;1500
10.122.146.116;1581
10.122.146.117;1500
10.122.146.117;1581
10.122.146.123;1500
10.122.146.123;1581
10.122.151.7;5432
10.123.12.192;1433
10.123.20.209;1433
10.123.27.204;1433
10.123.8.17;5401
10.123.8.17;5404
10.123.8.17;21
10.123.8.184;21
10.123.8.184;22
10.123.8.196;1521
10.123.8.27;5404
10.123.8.58;1521
10.123.8.60;1521
10.123.9.6;1521
10.123.9.7;1521
10.123.9.8;1521
10.128.16.15;249
10.128.16.15;2490
10.128.16.38;249
10.128.16.38;32490
10.192.10.174;21
10.192.10.174;80
10.192.127.151;5432
10.192.127.151;22
10.192.127.155;5432
10.192.127.155;22
10.192.176.205;50000
10.192.176.205;50700
10.192.176.205;111
10.192.176.205;2049
10.192.176.92;2481
10.192.176.92;2483
10.192.176.99;1521
10.192.2.131;1364
10.192.230.101;1521
10.192.230.250;5432
10.192.230.250;111
10.192.230.250;2049
10.192.230.250;22
10.192.230.56;1521
10.192.32.105;21
10.192.32.167;21
10.192.32.167;22
10.192.39.56;1023
10.192.39.56;15001
10.192.39.56;1918
10.192.39.56;6014
10.192.39.56;21
10.192.8.176;5021
10.192.8.183;21
10.192.8.183;22
10.192.9.106;1521
10.192.9.211;2480
10.192.9.211;2483
10.219.193.18;3681
10.219.193.19;3681
10.219.193.20;3681
10.219.193.31;3681
10.219.193.32;3681
10.219.193.33;3681
10.219.193.34;3681
10.219.193.35;3681
10.219.193.36;3681
10.219.193.37;3681
10.219.193.38;3681
10.222.149.227;1521
10.222.160.40;1521
10.222.160.41;1521
10.222.160.42;1521
10.222.64.163;445
10.222.64.163;111
10.222.64.163;2049
10.223.10.122;5432
10.223.10.123;1500
10.223.10.123;1581
10.223.10.13;5432
10.223.10.137;5432
10.252.127.47;1500
10.252.127.47;1581
10.252.127.48;1500
10.252.127.48;1581
10.252.127.49;1500
10.252.127.49;1581
10.252.176.44;2481
10.252.176.79;1521
10.252.176.66;5432
10.252.176.125;5432
10.252.176.44;5020
10.252.176.47;2485
10.252.176.42;2487






#!/bin/bash

if [ ${#} -ne 1 ]
then
    echo "Passar o arquivo de lista no PARM1."
    exit 1
fi

LIP=`hostname -i`
LN=`hostname`

for a in `cat ${1} | egrep -iv "^$|^ "`
do
IP=`echo $a | cut -d';' -f1`
PT=`echo $a | cut -d';' -f2`
echo "----------------------------------"
timeout 3 telnet $IP $PT 1> telnet.tmp 2>&1
if [ `grep -ic "connected" telnet.tmp` -eq 0 ]
then
    echo "Teste De: [${LN}-$LIP] To: [${IP}] na Porta: [${PT}]"
    if [ `grep -ic "refused" telnet.tmp` -eq 0 ]
    then
        echo "------------------------------------"                  >> telnet_notok.txt
        echo "Teste De: [${LN}-$LIP] To: [${IP}] na Porta: [${PT}]"  >> telnet_notok.txt
        echo "Trying ${IP}..."                                       >> telnet_notok.txt
        echo ""                                                      >> telnet_notok.txt
    else
    echo "------------------------------------"                      >> telnet_notok.txt
    echo "Teste De: [${LN}-$LIP] To: [${IP}] na Porta: [${PT}]"      >> telnet_notok.txt
    cat telnet.tmp                                                   >> telnet_notok.txt
    echo ""                                                          >> telnet_notok.txt
    fi
else
    echo "Teste De: [${LN}-$LIP] To: [${IP}] na Porta: [${PT}]"

    echo "------------------------------------"                      >> telnet_ok.txt
    echo "Teste De: [${LN}-$LIP] To: [${IP}] na Porta: [${PT}]"      >> telnet_ok.txt
    cat telnet.tmp                                                   >> telnet_ok.txt
    echo ""                                                          >> telnet_ok.txt
fi
done


for a in `cat /tmp/telnet_ok.txt | grep "To:" | awk '{print $5,$8}' | sed 's/\] \[/\;/' | sed 's/\[//' | sed 's/\]//'`; do echo "$a: `cat telnet_ok.txt | grep "To:" | awk '{print $5,$8}' | sed 's/\] \[/\;/' | sed 's/\[//' | sed 's/\]//' | grep -c $a`"; done